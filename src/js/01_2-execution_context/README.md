# 실행 컨텍스트

- 변수를 알아보면서, 함수에 대해서 약간 이해하게되었고, 마지막 부분에 하나의 함수를 연속으로 실행하면 같은 함수를 실행하는건 맞지만, 실행하는 환경이 다르다는걸 이해했어
- 여기서 말하는 환경이란 뭘까?
- 찾아보니까 환경은 실행 컨텍스트라고 불리네
- 실행 컨텍스트를 비유한 문장이 인상적이네 -> "js 엔진이 코드를 평가하고 실행하기 위해 만드는 상자"
  - 특이점은 모든 js코드는 이 상자안에서 동작한다는 점이야
  - 앞서 알아본 개념과 합쳐보면 상자안에서 js 엔진이 코드를 평가/실행하는데 이 상자는 여러개가 존재 가능하구나
- 내 생각에는 모든 js 코드가 이 상자안에서 동작한다면, 세부적으로 여러 상자가 존재할수있겠지만, 결과적으로 모든 상자를 감싸는 상자가 존재해야할거같아
- 왜냐하면 그게 없다면 상자 - 상자가 너무 독립적이라 문제가 있을거같아

  - 당장 위 예시만 봐도 같은 함수를 다른 상자에서 사용한다고 했지만, 같은 함수는 어디에 있나? 라는 의문이 들어
  - 아마 가장 범위가 큰 상자에 있을꺼야

- 찾아보니까 이런 가장 큰 범위의 상자를 Global Execution Context라고 부르네
- 이건 js 코드가 로드될때 생성된다고 하네
  - 여기서 말하는 js 로드 시점이 뭘까? 코드가 실행되는 순간일까?
  - 아니네 js는 크게 3단계로 나뉘나봐
  - 로드 -> 파싱 -> 실행
  - 로드는 html등에서 <script> 태그를 만나는 순간에 js 파일이 불러와지는 것을 의미하는거 같아
  - 그 후에 파싱이라는 단계를 거치네 <- 이 과정에서 Global Execution Context가 생성되는구나
  - 파싱까지 완료되어야 실행이 되네
- Global Execution Context는 js가 파싱될때 ~ 종료될때까지 유지되나봐
- 주 역할은 전역 객체를 생성해서 this에 바인딩하는 역할이라고 하네

  - this에 왜 바인딩하지? 그냥 전역 객체 그대로 사용하면 안되나?
  - 분명 굳이 this에 바인딩하는 이유가 있을거같아
  - 찾아보니 ECMA에서 정의한 규칙중에 하나네
    - "자바스크릅티는 어디서든 this를 통해 현재 실행컨텍스트와 관련된 객체에 접근할 수 있다"

- 다른 범위의 실행컨텍스트로는 Function Execution Context가 존재하네
- 함수는 호출될때마다 새로운 Function Execution Context를 생성하는구나
- 그래서 앞서 봤던 예제에서 같은 함수를 호출해도 다른 실행컨텍스트가 되었구나
  - 중요한건 단순히 선언한다고 Function Execution Context가 생성되는게 아니야
- 함수가 return을 만나서 종료되면 실행컨텍스트 스택에서 제거되고 메모리에서 해제되네
  - 그러면 모든 실행컨텍스트는 독립적인 스택과 메모리가 존재하는걸까?
  - 아니면 스택은 독립적이고 메모리는 공유일까?
  - 아니구나 내가 완전 잘못생각했네
  - Function Execution Context 자체가 실행컨텍스트 중 하나야
  - 그렇다면 종료되면 스택에서 지워진다는건 이 컨텍스트 자체가 스택에서 빠지는거야
  - 나는 실행 컨텍스트가 콜스택보다 넓은 범위인줄알았는데 js엔진은 싱글 쓰레드고 쓰레드에 하나의 스택만 가지는구나
- eval Execution Context라는 것도 존재하고 이건 함수 생성시 생성되는 컨텍스트인데 보안상의 이유로 eval이 거의 사용되지 않아서 일단 이정도만 알면될거같아

- 정리해보자
  - js엔진은 싱글쓰레드이고 하나의 스택이 존재해
  - 이 스택에 올라가면 그게 일종의 실행일꺼야
  - 또한 이 스택은 나중에 올라간게 제일먼저 제거되니까
  - 아마도 처음 ~ 끝까지 존재하는 Global Execution Context가 제일 먼저 올라갈꺼야
  - 그 이후에 함수가 호출되면 Function Execution Context가 올라가고
  - 함수가 종료되면 Function Execution Context가 빠지겠네
